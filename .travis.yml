sudo: required
language: go
go:
- "1.13"

cache:
  directories:
  - $GOPATH/pkg/mod
  - $GOPATH/bin
  - $HOME/.cache/go-build

before_install:
- git config --global url.git@github.com:.insteadof https://github.com/

install:
- echo 'KEY' >> $HOME/.ssh/known_hosts

script:
- rm -f go.sum /tmp/go-tools.go.mod.tidy.bak /tmp/go-tools.go.mod.tidy
- cp go.mod /tmp/go-tools.go.mod.tidy.bak
- go mod tidy
- mv go.mod /tmp/go-tools.go.mod.tidy
- mv /tmp/go-tools.go.mod.tidy.bak go.mod
- diff go.mod /tmp/go-tools.go.mod.tidy
- make .lint-mod-tidy
- make .lint-fmt
- make .lint-goimports
- make .lint-vet
- make .lint-revive
- make .lint-fix
- make lint

branches:
  only:
  - master

notifications:
  slack:
    secure: A/BZm/7ISFDUQi+IDYtmph8Jd7Un7Gpbl1N/L7J53dpvwirHEcoir4a105fgDAVw21JQ8YFQNZTtwR42YGKd1uUs3F+u5PwXk5e3FmU2yCfAhT7Fc7G7rlR4TzsF8llltKUqxv34yBU3P6pmosomMkyyV1ohbAqB10uctxqa02w=
